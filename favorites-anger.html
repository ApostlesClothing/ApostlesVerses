<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Favorites: Hope</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="favorites-style.css" />
</head>
<body>
  <header>

<!-- Unfavorite Confirmation Modal -->
<div id="confirm-unfavorite" style="display:none;" class="modal-overlay">
  <div class="modal-box">
    <p>Are you sure you want to remove this image from your favorites?</p>
    <div class="modal-buttons">
      <button id="confirm-yes">Yes</button>
      <button id="confirm-no">No</button>
    </div>
  </div>
</div>

    <a href="favorites.html" class="back-button">← Back to Favorites</a>
    <h1>⭐ Favorites: Anger</h1>
  </header>

  <div class="image-grid" id="favoritesGrid"></div>
  <p id="no-favs" style="text-align:center; opacity: 0.6;">No favorites saved yet for this topic.</p>

  <div id="lightbox" onclick="this.style.display='none'">
    <img id="lightbox-img" src="" alt="Full View" />
  </div>
<script>
  const favorites = JSON.parse(localStorage.getItem("favorites") || "[]");
  const filtered = favorites.filter(f => f.category === "anger"); // change for each topic

  const container = document.getElementById("favoritesGrid");
  const noFavs = document.getElementById("no-favs");

  if (filtered.length === 0) {
    noFavs.style.display = "block";
  } else {
    noFavs.style.display = "none";
    filtered.forEach(fav => {
      const wrapper = document.createElement("div");
      wrapper.className = "image-wrapper";

      const img = document.createElement("img");
      const imgPath = `images/${fav.category}/${fav.imageNumber}.png`;
      img.src = imgPath;
      img.onclick = () => {
        lightboxImg.src = img.src;
        lightbox.style.display = "flex";
      };

      const heart = document.createElement("div");
      heart.className = "favorite-icon";
      heart.textContent = "❤️";
      heart.onclick = (e) => {
  e.stopPropagation();

  // Store selected item for removal later
  let pendingRemove = fav;
  let wrapperToRemove = wrapper;

  const modal = document.getElementById("confirm-unfavorite");
  const yesBtn = document.getElementById("confirm-yes");
  const noBtn = document.getElementById("confirm-no");

  modal.style.display = "flex";

  // Clear previous listeners
  yesBtn.onclick = () => {
    const updated = favorites.filter(f =>
      !(f.category === pendingRemove.category && f.imageNumber === pendingRemove.imageNumber)
    );
    localStorage.setItem("favorites-es", JSON.stringify(updated));
    wrapperToRemove.remove();
    modal.style.display = "none";

    if (updated.length === 0) {
      noFavs.style.display = "block";
    }
  };

  noBtn.onclick = () => {
    modal.style.display = "none";
  };
};


      // ✅ NEW: Download button
      const download = document.createElement("a");
      download.href = imgPath;
      download.download = `${fav.category}-${fav.imageNumber}.png`;
      download.textContent = "⬇️";
      download.className = "download-button";
      download.onclick = (e) => e.stopPropagation();

      wrapper.appendChild(img);
      wrapper.appendChild(heart);
      wrapper.appendChild(download);
      container.appendChild(wrapper);
    });
  }
</script>

</body>
</html>